<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Audio Registers - Pan Docs</title>


        <!-- Custom HTML head -->
        <!-- Open Graph tags-->
        <meta name="og:site_name" content="summary" />
        <meta name="og:image" content="https://gbdev.io/pandocs/favicon.png" />
        <meta name="og:title" content="Audio Registers - Pan Docs" />
        <meta name="og:description" content="The single, most comprehensive technical reference to Game Boy available to the public." />
        
        <!-- Twitter meta tags -->
        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@gbdev0" />
        
        <!-- MathML polyfill for Chrome -->
        <script src="https://fred-wang.github.io/mathml.css/mspace.js"></script>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="The single, most comprehensive technical reference to Game Boy available to the public.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="custom/style.css">

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item affix "><a href="About.html">Foreword</a></li><li class="chapter-item affix "><a href="Authors.html">Acknowledgements</a></li><li class="chapter-item affix "><a href="History.html">History</a></li><li class="spacer"></li><li class="chapter-item affix "><li class="part-title">Overview</li><li class="chapter-item "><a href="Specifications.html"><strong aria-hidden="true">1.</strong> Specifications</a></li><li class="chapter-item "><a href="Memory_Map.html"><strong aria-hidden="true">2.</strong> Memory Map</a></li><li class="chapter-item affix "><li class="part-title">I/O Ports</li><li class="chapter-item "><a href="Rendering.html"><strong aria-hidden="true">3.</strong> Rendering</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="Tile_Data.html"><strong aria-hidden="true">3.1.</strong> Tile Data</a></li><li class="chapter-item "><a href="Tile_Maps.html"><strong aria-hidden="true">3.2.</strong> Tile Maps</a></li><li class="chapter-item "><a href="OAM.html"><strong aria-hidden="true">3.3.</strong> OAM</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="OAM_DMA_Transfer.html"><strong aria-hidden="true">3.3.1.</strong> OAM DMA Transfer</a></li></ol></li><li class="chapter-item "><a href="LCDC.html"><strong aria-hidden="true">3.4.</strong> LCD Control</a></li><li class="chapter-item "><a href="STAT.html"><strong aria-hidden="true">3.5.</strong> LCD Status</a></li><li class="chapter-item "><a href="Scrolling.html"><strong aria-hidden="true">3.6.</strong> Scrolling</a></li><li class="chapter-item "><a href="Palettes.html"><strong aria-hidden="true">3.7.</strong> Palettes</a></li><li class="chapter-item "><a href="pixel_fifo.html"><strong aria-hidden="true">3.8.</strong> Pixel FIFO</a></li></ol></li><li class="chapter-item expanded "><a href="Audio.html"><strong aria-hidden="true">4.</strong> Audio</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="Audio_Registers.html" class="active"><strong aria-hidden="true">4.1.</strong> Audio Registers</a></li><li class="chapter-item "><a href="Audio_details.html"><strong aria-hidden="true">4.2.</strong> Audio Details</a></li></ol></li><li class="chapter-item "><a href="Joypad_Input.html"><strong aria-hidden="true">5.</strong> Joypad Input</a></li><li class="chapter-item "><a href="Serial_Data_Transfer_(Link_Cable).html"><strong aria-hidden="true">6.</strong> Serial Data Transfer</a></li><li class="chapter-item "><a href="Timer_and_Divider_Registers.html"><strong aria-hidden="true">7.</strong> Timer and Divider Registers</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="Timer_Obscure_Behaviour.html"><strong aria-hidden="true">7.1.</strong> Timer Obscure Behaviour</a></li></ol></li><li class="chapter-item "><a href="Interrupts.html"><strong aria-hidden="true">8.</strong> Interrupts</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="Interrupt_Sources.html"><strong aria-hidden="true">8.1.</strong> Interrupt Sources</a></li><li class="chapter-item "><a href="halt.html"><strong aria-hidden="true">8.2.</strong> HALT</a></li></ol></li><li class="chapter-item "><a href="CGB_Registers.html"><strong aria-hidden="true">9.</strong> CGB Registers</a></li><li class="chapter-item "><a href="IR.html"><strong aria-hidden="true">10.</strong> Infrared Communication</a></li><li class="chapter-item "><a href="SGB_Functions.html"><strong aria-hidden="true">11.</strong> SGB Functions</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="SGB_Unlocking.html"><strong aria-hidden="true">11.1.</strong> Unlocking and Detecting SGB Functions</a></li><li class="chapter-item "><a href="SGB_Command_Packet.html"><strong aria-hidden="true">11.2.</strong> Command Packet Transfers</a></li><li class="chapter-item "><a href="SGB_VRAM_Transfer.html"><strong aria-hidden="true">11.3.</strong> VRAM Transfers</a></li><li class="chapter-item "><a href="SGB_Color_Palettes.html"><strong aria-hidden="true">11.4.</strong> Color Palettes Overview</a></li><li class="chapter-item "><a href="SGB_Command_Summary.html"><strong aria-hidden="true">11.5.</strong> Command Summary</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="SGB_Command_Palettes.html"><strong aria-hidden="true">11.5.1.</strong> Palette Commands</a></li><li class="chapter-item "><a href="SGB_Command_Attribute.html"><strong aria-hidden="true">11.5.2.</strong> Color Attribute Commands</a></li><li class="chapter-item "><a href="SGB_Command_Sound.html"><strong aria-hidden="true">11.5.3.</strong> Sound Functions</a></li></ol></li><li class="chapter-item "><a href="SGB_Command_System.html"><strong aria-hidden="true">11.6.</strong> System Control Commands</a></li><li class="chapter-item "><a href="SGB_Command_Multiplayer.html"><strong aria-hidden="true">11.7.</strong> Multiplayer Command</a></li><li class="chapter-item "><a href="SGB_Command_Border.html"><strong aria-hidden="true">11.8.</strong> Border and OBJ Commands</a></li><li class="chapter-item "><a href="SGB_Command_Undocumented.html"><strong aria-hidden="true">11.9.</strong> Undocumented SGB commands</a></li></ol></li><li class="chapter-item "><li class="part-title">CPU Specifications</li><li class="chapter-item "><a href="CPU_Registers_and_Flags.html"><strong aria-hidden="true">12.</strong> CPU Registers and Flags</a></li><li class="chapter-item "><a href="CPU_Instruction_Set.html"><strong aria-hidden="true">13.</strong> CPU Instruction Set</a></li><li class="chapter-item "><a href="CPU_Comparison_with_Z80.html"><strong aria-hidden="true">14.</strong> CPU Comparison with Z80</a></li><li class="chapter-item affix "><li class="part-title">Cartridges</li><li class="chapter-item "><a href="The_Cartridge_Header.html"><strong aria-hidden="true">15.</strong> The Cartridge Header</a></li><li class="chapter-item "><a href="MBCs.html"><strong aria-hidden="true">16.</strong> MBCs</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="nombc.html"><strong aria-hidden="true">16.1.</strong> No MBC</a></li><li class="chapter-item "><a href="MBC1.html"><strong aria-hidden="true">16.2.</strong> MBC1</a></li><li class="chapter-item "><a href="MBC2.html"><strong aria-hidden="true">16.3.</strong> MBC2</a></li><li class="chapter-item "><a href="MBC3.html"><strong aria-hidden="true">16.4.</strong> MBC3</a></li><li class="chapter-item "><a href="MBC5.html"><strong aria-hidden="true">16.5.</strong> MBC5</a></li><li class="chapter-item "><a href="MBC6.html"><strong aria-hidden="true">16.6.</strong> MBC6</a></li><li class="chapter-item "><a href="MBC7.html"><strong aria-hidden="true">16.7.</strong> MBC7</a></li><li class="chapter-item "><a href="MMM01.html"><strong aria-hidden="true">16.8.</strong> MMM01</a></li><li class="chapter-item "><a href="M161.html"><strong aria-hidden="true">16.9.</strong> M161</a></li><li class="chapter-item "><a href="HuC1.html"><strong aria-hidden="true">16.10.</strong> HuC1</a></li><li class="chapter-item "><a href="HuC3.html"><strong aria-hidden="true">16.11.</strong> HuC-3</a></li><li class="chapter-item "><a href="othermbc.html"><strong aria-hidden="true">16.12.</strong> Other MBCs</a></li></ol></li><li class="chapter-item "><li class="part-title">Accessories</li><li class="chapter-item "><a href="Gameboy_Printer.html"><strong aria-hidden="true">17.</strong> Game Boy Printer</a></li><li class="chapter-item "><a href="Gameboy_Camera.html"><strong aria-hidden="true">18.</strong> Game Boy Camera</a></li><li class="chapter-item "><a href="Four_Player_Adapter.html"><strong aria-hidden="true">19.</strong> 4-Player Adapter</a></li><li class="chapter-item "><a href="Shark_Cheats.html"><strong aria-hidden="true">20.</strong> Game Genie/Shark Cheats</a></li><li class="chapter-item affix "><li class="part-title">Other</li><li class="chapter-item "><a href="Power_Up_Sequence.html"><strong aria-hidden="true">21.</strong> Power-Up Sequence</a></li><li class="chapter-item "><a href="Reducing_Power_Consumption.html"><strong aria-hidden="true">22.</strong> Reducing Power Consumption</a></li><li class="chapter-item "><a href="Accessing_VRAM_and_OAM.html"><strong aria-hidden="true">23.</strong> Accessing VRAM and OAM</a></li><li class="chapter-item "><a href="OAM_Corruption_Bug.html"><strong aria-hidden="true">24.</strong> OAM Corruption Bug</a></li><li class="chapter-item "><a href="External_Connectors.html"><strong aria-hidden="true">25.</strong> External Connectors</a></li><li class="chapter-item "><a href="GBC_Approval_Process.html"><strong aria-hidden="true">26.</strong> GBC Approval Process</a></li><li class="spacer"></li><li class="chapter-item affix "><a href="References.html">References</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Pan Docs</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/gbdev/pandocs" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/gbdev/pandocs/edit/master/src/Audio_Registers.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="audio-registers"><a class="header" href="#audio-registers">Audio Registers</a></h1>
<p>Audio registers are named following a <code>NRxy</code> scheme, where <code>x</code> is the channel number (or <code>5</code> for “global” registers), and <code>y</code> is the register’s ID within the channel.
Since many registers share common properties, a notation is often used where e.g. <code>NRx2</code> is used to designate <code>NR12</code>, <code>NR22</code>, <code>NR32</code>, and <code>NR42</code> at the same time, for simplicity.</p>
<p>As a rule of thumb, for any <code>x</code> in <code>1</code>, <code>2</code>, <code>3</code>, <code>4</code>:</p>
<ul>
<li><code>NRx0</code> is some channel-specific feature (if present),</li>
<li><code>NRx1</code> controls the length timer,</li>
<li><code>NRx2</code> controls the volume and envelope,</li>
<li><code>NRx3</code> controls the wavelength (maybe only partially),</li>
<li><code>NRx4</code> has the channel’s trigger and length timer enable bits;</li>
</ul>
<p>…but there are some exceptions.</p>
<p>One of the pitfalls of the <code>NRxy</code> naming convention is that the register’s purpose is not immediately clear from its name, so some alternative names have been proposed, <a href="https://github.com/gbdev/hardware.inc/blob/05f5a9b6c7172abe1d7488080c1c050284c09226/hardware.inc#L415">such as <code>AUDENA</code> for <code>NR52</code></a>.</p>
<h2 id="global-control-registers"><a class="header" href="#global-control-registers">Global control registers</a></h2>
<h3 id="ff26--nr52-sound-onoff"><a class="header" href="#ff26--nr52-sound-onoff">FF26 — NR52: Sound on/off</a></h3>
<p>This register controls whether the APU is powered on at all (akin to <a href="LCDC.html#lcdc7--lcd-enable"><code>LCDC</code> bit 7</a>), and allows checking whether channels are active<sup class="footnote-reference"><a href="#nr52_dac">1</a></sup>.
Turning the APU off drains less power (around 16%), but clears all APU registers and makes them read-only until turned back on, except <code>NR52</code><sup class="footnote-reference"><a href="#dmg_apu_off">2</a></sup>.</p>
<pre><code> Bit 7 - All sound on/off  (0: turn the APU off) (Read/Write)
 Bit 3 - Channel 4 ON flag (Read Only)
 Bit 2 - Channel 3 ON flag (Read Only)
 Bit 1 - Channel 2 ON flag (Read Only)
 Bit 0 - Channel 1 ON flag (Read Only)
</code></pre>
<p>Bits 0-3 of this register are read-only status bits.
Writing to those does NOT enable or disable the channels, despite many emulators behaving as if.</p>
<p>A channel is turned on by triggering it (i.e. setting bit 7 of <code>NRx4</code>)<sup class="footnote-reference"><a href="#dac_off">3</a></sup>.
A channel is turned off when any of the following occurs:</p>
<ul>
<li>The channel’s length timer, if enabled in <code>NRx4</code>, expires</li>
<li>For CH1: when the wavelength sweep overflows<sup class="footnote-reference"><a href="#freq_sweep_underflow">4</a></sup></li>
<li><a href="Audio_details.html#dacs">The channel’s DAC</a> is turned off</li>
</ul>
<p>The envelope reaching a volume of 0 does NOT turn the channel off!</p>
<div class="footnote-definition" id="nr52_dac"><sup class="footnote-definition-label">1</sup>
<p>Actually, the low nibble of NR52 only reports whether the channels’ <em>generation</em> circuits are enabled, not if <a href="Audio_details.html#dacs">the DACs</a> are.</p>
</div>
<div class="footnote-definition" id="dmg_apu_off"><sup class="footnote-definition-label">2</sup>
<p>…and the length timers (in <code>NRx1</code>) on monochrome models.</p>
</div>
<div class="footnote-definition" id="dac_off"><sup class="footnote-definition-label">3</sup>
<p>If <a href="Audio_details.html#dacs">the DAC</a> is off, then the write to NRx4 will be ineffective and won’t turn the channel on.</p>
</div>
<div class="footnote-definition" id="freq_sweep_underflow"><sup class="footnote-definition-label">4</sup>
<p>The wavelength sweep cannot normally underflow, so a “decreasing” sweep (<code>NR10</code> bit 3 set) won’t turn the channel off.</p>
</div>
<h3 id="ff25--nr51-sound-panning"><a class="header" href="#ff25--nr51-sound-panning">FF25 — NR51: Sound panning</a></h3>
<p>Each channel can be panned hard left, center, hard right, or ignored entirely.</p>
<pre><code>Bit 7 - Mix channel 4 into left output
Bit 6 - Mix channel 3 into left output
Bit 5 - Mix channel 2 into left output
Bit 4 - Mix channel 1 into left output
Bit 3 - Mix channel 4 into right output
Bit 2 - Mix channel 3 into right output
Bit 1 - Mix channel 2 into right output
Bit 0 - Mix channel 1 into right output
</code></pre>
<h3 id="ff24--nr50-master-volume--vin-panning"><a class="header" href="#ff24--nr50-master-volume--vin-panning">FF24 — NR50: Master volume &amp; VIN panning</a></h3>
<p>The volume bits specify the master volume, i.e. how much each output should be scaled.
A value of 0 is treated as a volume of 1 (very quiet), and a value of 7 is treated as a volume of 8 (no volume reduction).
Importantly, the amplifier <strong>never mutes</strong> a non-silent input.</p>
<p>The VIN mixing bits work exactly like bits in <a href="Audio_Registers.html#ff25--nr51-sound-panning"><code>NR51</code></a>.</p>
<pre><code>Bit 7   - Mix VIN into left output  (1=Enable)
Bit 6-4 - Left output volume        (0-7)
Bit 3   - Mix VIN into right output (1=Enable)
Bit 2-0 - Right output volume       (0-7)
</code></pre>
<h2 id="sound-channel-1--pulse-with-wavelength-sweep"><a class="header" href="#sound-channel-1--pulse-with-wavelength-sweep">Sound Channel 1 — Pulse with wavelength sweep</a></h2>
<h3 id="ff10--nr10-channel-1-sweep"><a class="header" href="#ff10--nr10-channel-1-sweep">FF10 — NR10: Channel 1 sweep</a></h3>
<p>This register controls CH1’s wavelength sweep functionality.</p>
<pre><code>Bit 6-4 - Sweep pace
Bit 3   - Sweep increase/decrease
           0: Addition    (wavelength increases)
           1: Subtraction (wavelength decreases)
Bit 2-0 - Sweep slope control (n: 0-7)
</code></pre>
<p>The <var>sweep pace</var> dictates how often the wavelength gets changed, in units of 128 Hz ticks<sup class="footnote-reference"><a href="#div_apu">5</a></sup> (7.8 ms).
The pace is only reloaded after the following sweep iteration, or when (re)triggering the channel.
However, if bits 4–6 are all set to 0, then iterations are instantly disabled, and the pace will be reloaded immediately if it’s set to something else.</p>
<p>On each sweep iteration, the wavelength in <a href="Audio_Registers.html#ff13--nr13-channel-1-wavelength-low-write-only"><code>NR13</code></a> and <a href="Audio_Registers.html#ff14--nr14-channel-1-wavelength-high--control"><code>NR14</code></a> is modified and written back.
That is, unless <var>n</var> (the slope) is 0, in which case iterations do nothing (in this case, subtraction mode should be set, see below).</p>
<p>On each tick, the new wavelength <math><msub><mi>L</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></math> is computed from the current one <math><msub><mi>L</mi><mi>t</mi></msub></math> as follows:</p>
<math display="block">
  <msub><mi>L</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub> <mo>=</mo> <msub><mi>L</mi><mi>t</mi></msub> <mo>±</mo> <mfrac><msub><mi>L</mi><mi>t</mi></msub><msup><mn>2</mn><mi>n</mi></msup></mfrac>
</math>
<p>In addition mode, if the wavelength would overflow (i.e. <math><msub><mi>L</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></math> is strictly more than $7FF), the channel is turned off instead.
<strong>This occurs even if sweep iterations are disabled</strong> by <var>n</var> = 0.</p>
<p>Note that if the wavelength ever becomes 0, the wavelength sweep will never be able to change it.
For the same reason, the wavelength sweep cannot underflow the wavelength (which would turn the channel off).</p>
<div class="footnote-definition" id="div_apu"><sup class="footnote-definition-label">5</sup>
<p><a href="Audio_details.html#div-apu">As long as <code>DIV</code> is not written to</a>.</p>
</div>
<h3 id="ff11--nr11-channel-1-length-timer--duty-cycle"><a class="header" href="#ff11--nr11-channel-1-length-timer--duty-cycle">FF11 — NR11: Channel 1 length timer &amp; duty cycle</a></h3>
<p>This register controls both the channel’s <a href="Audio.html#length-timer">length timer</a> and <a href="https://en.wikipedia.org/wiki/Duty_cycle">duty cycle</a> (the ratio of the time spent low vs. high).
However, the selected duty cycle also alters the phase, although the effect is hardly noticeable.</p>
<pre><code>Bit 7-6 - Wave duty            (Read/Write)
Bit 5-0 - Initial length timer (Write Only)
</code></pre>
<style>
.waveform {
  display: block;
  width: 16rem;
  background-image: repeating-linear-gradient(to right, var(--bg), var(--bg) 1rem, var(--table-alternate-bg) 1rem, var(--table-alternate-bg) 2rem);
  border: 1px solid var(--table-header-bg);
}
.waveform polyline {
  stroke-width: 1px;
  stroke: var(--inline-code-color);
  fill: none;
}
</style>
<div class="table-wrapper"><table><thead><tr><th style="text-align: right">Wave duty (binary)</th><th style="text-align: center">Duty cycle</th><th>Waveform</th></tr></thead><tbody>
<tr><td style="text-align: right">00</td><td style="text-align: center">12.5 %</td><td><svg viewBox="0 -1 80 12" preserveAspectRatio="xMidYMid meet" class="waveform"><polyline points="0,0 35,0 35,10 40,10 40,0 75,0 75,10 80,10 80,0"/></svg></td></tr>
<tr><td style="text-align: right">01</td><td style="text-align: center">25 %</td><td><svg viewBox="0 -1 80 12" preserveAspectRatio="xMidYMid meet" class="waveform"><polyline points="0,10 5,10 5,0 35,0 35,10 45,10 45,0 75,0 75,10 80,10"/></svg></td></tr>
<tr><td style="text-align: right">10</td><td style="text-align: center">50 %</td><td><svg viewBox="0 -1 80 12" preserveAspectRatio="xMidYMid meet" class="waveform"><polyline points="0,10 5,10 5,0 25,0 25,10 45,10 45,0 65,0 65,10 80,10"/></svg></td></tr>
<tr><td style="text-align: right">11</td><td style="text-align: center">75 %</td><td><svg viewBox="0 -1 80 12" preserveAspectRatio="xMidYMid meet" class="waveform"><polyline points="0,0 5,0 5,10 35,10 35,0 45,0 45,10 75,10 75,0 80,0"/></svg></td></tr>
</tbody></table>
</div>
<p>It’s worth noting that there is no audible difference between the 25 % and 75 % duty cycle settings.</p>
<p>The higher the <a href="Audio.html#length-timer">length timer</a> field, the shorter the time before the channel is cut.</p>
<h3 id="ff12--nr12-channel-1-volume--envelope"><a class="header" href="#ff12--nr12-channel-1-volume--envelope">FF12 — NR12: Channel 1 volume &amp; envelope</a></h3>
<p>This register controls the digital amplitude of the “high” part of the pulse, and the sweep applied to that setting.</p>
<pre><code>Bit 7-4 - Initial volume of envelope (0-F) (0=No Sound)
Bit 3   - Envelope direction (0=Decrease, 1=Increase)
Bit 2-0 - Sweep pace (0=No Sweep)
</code></pre>
<p>Setting bits 3-7 of this register all to 0 turns the DAC off (and thus, the channel as well).</p>
<p>The envelope ticks at 64 Hz, and the channel’s envelope will be increased / decreased (depending on bit 3) every <var>Sweep pace</var> of those ticks.</p>
<p>Writes to this register while the channel is on require retriggering it afterwards.</p>
<h3 id="ff13--nr13-channel-1-wavelength-low-write-only"><a class="header" href="#ff13--nr13-channel-1-wavelength-low-write-only">FF13 — NR13: Channel 1 wavelength low [write-only]</a></h3>
<p>This register stores the low 8 bits of the channel’s 11-bit “<a href="Audio.html#frequency">wavelength</a>”.
The upper 3 bits are stored in the low 3 bits of <code>NR14</code>.</p>
<p>The actual signal frequency is <math><mfrac><mn>131072</mn><mrow><mn>2048</mn><mo>-</mo><mi>wavelen</mi></mrow></mfrac></math> Hz: the higher the value, the higher the frequency.
This is the whole wave’s frequency; the rate at which the channel steps through the 8 “steps” in its wave form is 8× that, i.e. <math><mfrac><mn>1048576</mn><mrow><mn>2048</mn><mo>-</mo><mi>wavelen</mi></mrow></mfrac></math> Hz = <math><mfrac><mn>1</mn><mrow><mn>2048</mn><mo>-</mo><mn>wavelen</mn></mrow></mfrac></math> MiHz.</p>
<h3 id="ff14--nr14-channel-1-wavelength-high--control"><a class="header" href="#ff14--nr14-channel-1-wavelength-high--control">FF14 — NR14: Channel 1 wavelength high &amp; control</a></h3>
<pre><code>Bit 7   - Trigger (1=Restart channel)  (Write Only)
Bit 6   - Sound Length enable          (Read/Write)
          (1=Stop output when length in NR11 expires)
Bit 2-0 - &quot;Wavelength&quot;'s higher 3 bits (Write Only)
</code></pre>
<p>Writing a value here with bit 7 set <a href="Audio.html#triggering">triggers</a> the channel.</p>
<p>Bit 6 takes effect immediately upon writing to this register.</p>
<h2 id="sound-channel-2--pulse"><a class="header" href="#sound-channel-2--pulse">Sound Channel 2 — Pulse</a></h2>
<p>This sound channel works exactly like channel 1, except that it lacks a wavelength sweep (and thus an equivalent to <a href="Audio_Registers.html#ff10--nr10-channel-1-sweep"><code>NR10</code></a>).
Please refer to the corresponding CH1 register:</p>
<ul>
<li><code>NR21</code> → <a href="Audio_Registers.html#ff11--nr11-channel-1-length-timer--duty-cycle"><code>NR11</code></a></li>
<li><code>NR22</code> → <a href="Audio_Registers.html#ff12--nr12-channel-1-volume--envelope"><code>NR12</code></a></li>
<li><code>NR23</code> → <a href="Audio_Registers.html#ff13--nr13-channel-1-wavelength-low-write-only"><code>NR13</code></a></li>
<li><code>NR24</code> → <a href="Audio_Registers.html#ff14--nr14-channel-1-wavelength-high--control"><code>NR14</code></a></li>
</ul>
<h2 id="sound-channel-3--wave-output"><a class="header" href="#sound-channel-3--wave-output">Sound Channel 3 — Wave output</a></h2>
<p>While other channels only offer limited control over the waveform they generate, this channel allows outputting any wave.
It’s thus sometimes called a “voluntary wave” channel.</p>
<p>While the “length” of the wave is fixed at 32 “samples”, 4-bit each, the speed at which it is read can be customized.
It’s possible to “shorten” the wave by either feeding it a repeating pattern, or doubling each sample and doubling the read rate.
It’s also possible to artificially “increase” the wave’s length by loading a new wave as soon as the whole buffer has been read; this is sometimes used for full-on sample playback.</p>
<h3 id="ff1a--nr30-channel-3-dac-enable"><a class="header" href="#ff1a--nr30-channel-3-dac-enable">FF1A — NR30: Channel 3 DAC enable</a></h3>
<p>This register controls CH3’s DAC.
Like other channels, turning the DAC off immediately turns the channel off as well.</p>
<pre><code>Bit 7 - Sound Channel 3 DAC  (0=Off, 1=On)
</code></pre>
<p>The channel is often turned off just before writing to <a href="Audio_Registers.html#ff30ff3f--wave-pattern-ram">wave RAM</a> to avoid issues with accessing it; see there for more info.</p>
<h3 id="ff1b--nr31-channel-3-length-timer-write-only"><a class="header" href="#ff1b--nr31-channel-3-length-timer-write-only">FF1B — NR31: Channel 3 length timer [write-only]</a></h3>
<p>This register controls the channel’s <a href="Audio.html#length-timer">length timer</a>.</p>
<pre><code>Bit 5-0 - length timer
</code></pre>
<p>The higher the <a href="Audio.html#length-timer">length timer</a>, the shorter the time before the channel is cut.</p>
<h3 id="ff1c--nr32-channel-3-output-level"><a class="header" href="#ff1c--nr32-channel-3-output-level">FF1C — NR32: Channel 3 output level</a></h3>
<p>This channel lacks the envelope functionality that the other three channels have.</p>
<pre><code>Bits 6-5 - Output level selection
</code></pre>
<div class="table-wrapper"><table><thead><tr><th style="text-align: right">Bits 6-5 (binary)</th><th>Output level</th></tr></thead><tbody>
<tr><td style="text-align: right">%00</td><td>Mute (No sound)</td></tr>
<tr><td style="text-align: right">%01</td><td>100% volume (use samples read from Wave RAM as-is)</td></tr>
<tr><td style="text-align: right">%10</td><td>50% volume (shift samples read from Wave RAM right once)</td></tr>
<tr><td style="text-align: right">%11</td><td>25% volume (shift samples read from Wave RAM right twice)</td></tr>
</tbody></table>
</div>
<h3 id="ff1d--nr33-channel-3-wavelength-low-write-only"><a class="header" href="#ff1d--nr33-channel-3-wavelength-low-write-only">FF1D — NR33: Channel 3 wavelength low [write-only]</a></h3>
<p>This register stores the low 8 bits of the channel’s 11-bit “<a href="Audio.html#frequency">wavelength</a>”.
The upper 3 bits are stored in the low 3 bits of <code>NR34</code>.</p>
<p>The actual signal frequency is <math><mfrac><mn>65536</mn><mrow><mn>2048</mn><mo>-</mo><mi>wavelen</mi></mrow></mfrac></math> Hz: the higher the value, the higher the frequency.
This is the whole wave’s frequency; the rate at which the channel steps through the 8 “indices” in its wave form is 32 times that, i.e. <math><mfrac><mn>2097152</mn><mrow><mn>2048</mn><mo>-</mo><mi>wavelen</mi></mrow></mfrac></math>) Hz = <math><mfrac><mn>2</mn><mrow><mn>2048</mn><mo>-</mo><mi>wavelen</mi></mrow></mfrac></math> MiHz.</p>
<div class="box warning">
<p class="box-title">DELAY</p><p>Wavelength changes (written to <code>NR33</code> or <code>NR34</code>) only take effect after the following time wave RAM is read.
(<a href="https://github.com/LIJI32/SameSuite/blob/master/apu/channel_3/channel_3_freq_change_delay.asm">Source</a>)</p>
</div>
<h3 id="ff1e--nr34-channel-3-wavelength-high--control"><a class="header" href="#ff1e--nr34-channel-3-wavelength-high--control">FF1E — NR34: Channel 3 wavelength high &amp; control</a></h3>
<pre><code>Bit 7   - Trigger (1=Restart Sound)    (Write Only)
Bit 6   - Sound Length enable          (Read/Write)
          (1=Stop output when length in NR31 expires)
Bit 2-0 - &quot;Wavelength&quot;'s higher 3 bits (Write Only)
</code></pre>
<p>Writing a value here with bit 7 set <a href="Audio.html#triggering">triggers</a> the channel.</p>
<div class="box warning">
<p class="box-title">RETRIGGERING CAUTION</p><p>On monochrome consoles only, retriggering CH3 while it’s about to read a byte from wave RAM causes wave RAM to be corrupted in a generally unpredictable manner.</p>
</div>
<p>Bit 6 takes effect immediately upon writing to this register.</p>
<div class="box warning">
<p class="box-title">PLAYBACK DELAY</p><p>Triggering the wave channel does not immediately start playing wave RAM; instead, the <em>last</em> sample ever read (which is reset to 0 when the APU is off) is output until the channel next reads a sample.</p>
</div>
<h3 id="ff30ff3f--wave-pattern-ram"><a class="header" href="#ff30ff3f--wave-pattern-ram">FF30–FF3F — Wave pattern RAM</a></h3>
<p>Wave RAM is 16 bytes long; each byte holds two “samples”, each 4 bits.</p>
<p>As CH3 plays, it reads wave RAM left to right, upper nibble first.
That is, $FF30’s upper nibble, $FF30’s lower nibble, $FF31’s upper nibble, and so on.</p>
<div class="box warning">
<p class="box-title">ACCESS ORDER</p><p>When CH3 is started, the first sample read is the one at index <em>1</em>, i.e. the lower nibble of the first byte, NOT the upper nibble.
(<a href="https://github.com/LIJI32/SameSuite/blob/master/apu/channel_3/channel_3_first_sample.asm">Source</a>)</p>
</div>
<p>Accessing wave RAM while CH3 is <strong>active</strong> (i.e. playing) causes accesses to misbehave:</p>
<ul>
<li>On AGB, reads return $FF, and writes are ignored. (<a href="https://github.com/LIJI32/SameSuite/blob/master/apu/channel_3/channel_3_wave_ram_locked_write.asm">Source</a>)</li>
<li>On monochrome consoles, wave RAM can only be accessed on the same cycle that CH3 does.
Otherwise, reads return $FF, and writes are ignored.</li>
<li>On other consoles, the byte accessed will be the one CH3 is currently reading<sup class="footnote-reference"><a href="#wave_access">6</a></sup>; that is, if CH3 is currently reading one of the first two samples, the CPU will really access $FF30, regardless of the address being used. (<a href="https://github.com/LIJI32/SameSuite/blob/master/apu/channel_3/channel_3_wave_ram_locked_write.asm">Source</a>)</li>
</ul>
<p>Wave RAM <em>can</em> be accessed normally even if the DAC is on, as long as the channel is not active. (<a href="https://github.com/LIJI32/SameSuite/blob/master/apu/channel_3/channel_3_wave_ram_dac_on_rw.asm">Source</a>)
This is especially relevant on GBA, since <a href="Audio_details.html#game-boy-advance-audio">“DACs” are always enabled there</a>.</p>
<div class="footnote-definition" id="wave_access"><sup class="footnote-definition-label">6</sup>
<p>The way it works is that wave RAM is a 16-byte memory buffer, and while it’s playing, CH3 has priority over the CPU when choosing which of those 16 bytes is accessed.
So, from the CPU’s point of view, wave RAM reads out the same byte, regardless of the address.</p>
</div>
<h2 id="sound-channel-4--noise"><a class="header" href="#sound-channel-4--noise">Sound Channel 4 — Noise</a></h2>
<p>This channel is used to output white noise, which is done by randomly switching the amplitude between two levels fairly fast.</p>
<p>The frequency can be adjusted in order to make the noise appear “harder” (lower frequency) or “softer” (higher frequency).</p>
<p>The random function that switches the output level can also be manipulated.
Certain settings can cause the wave to be more regular, sounding closer to a pulse than noise.</p>
<h3 id="ff20--nr41-channel-4-length-timer-write-only"><a class="header" href="#ff20--nr41-channel-4-length-timer-write-only">FF20 — NR41: Channel 4 length timer [write-only]</a></h3>
<p>This register controls the channel’s <a href="Audio.html#length-timer">length timer</a>.</p>
<pre><code>Bit 5-0 - length timer
</code></pre>
<p>The higher the <a href="Audio.html#length-timer">length timer</a>, the shorter the time before the channel is cut.</p>
<h3 id="ff21--nr42-channel-4-volume--envelope"><a class="header" href="#ff21--nr42-channel-4-volume--envelope">FF21 — NR42: Channel 4 volume &amp; envelope</a></h3>
<p>This register controls the digital amplitude produced when the LFSR outputs a 1, and the sweep applied to that setting.</p>
<pre><code>Bit 7-4 - Initial volume of envelope (0-F) (0=No Sound)
Bit 3   - Envelope direction (0=Decrease, 1=Increase)
Bit 2-0 - Sweep pace (0=No Sweep)
</code></pre>
<p>Setting bits 3-7 of this register all to 0 turns the DAC off (and thus, the channel as well).</p>
<p>The envelope ticks at 64 Hz, and the channel’s envelope will be increased / decreased (depending on bit 3) every <var>Sweep pace</var> of those ticks.</p>
<h3 id="ff22--nr43-channel-4-frequency--randomness"><a class="header" href="#ff22--nr43-channel-4-frequency--randomness">FF22 — NR43: Channel 4 frequency &amp; randomness</a></h3>
<p>This register allows controlling the way the amplitude is randomly switched.</p>
<pre><code>Bit 7-4 - Clock shift (s)
Bit 3   - LFSR width (0=15 bits, 1=7 bits)
Bit 2-0 - Clock divider (r)
</code></pre>
<p>The frequency at which the LFSR is clocked is <math><mfrac><mn>262144</mn><mrow><mi>r</mi><mo>×</mo><msup><mn>2</mn><mi>s</mi></msup></mrow></mfrac></math> Hz.
(<var>r</var> = 0 is treated as <var>r</var> = 0.5 instead.)
If the bit shifted out is a 0, the channel emits a 0; otherwise, it emits the volume selected in <code>NR42</code>.</p>
<p>If the LFSR is set to 7-bit mode, the output will become more regular, and some frequencies will sound more like Pulse than Noise.
Note that switching from 15- to 7-bit mode when the LFSR <a href="Audio_details.html#noise-channel-ch4">is in a certain state</a> can “lock it up”, which essentially silences CH4; this can be avoided by retriggering CH4, which resets the LFSR.</p>
<h3 id="ff23--nr44-channel-4-control"><a class="header" href="#ff23--nr44-channel-4-control">FF23 — NR44: Channel 4 control</a></h3>
<pre><code>Bit 7   - Trigger (1=Restart channel)  (Write Only)
Bit 6   - Sound Length enable          (Read/Write)
          (1=Stop output when length in NR41 expires)
</code></pre>
<p>Writing a value here with bit 7 set <a href="Audio.html#triggering">triggers</a> the channel.</p>
<p>Bit 6 takes effect immediately upon writing to this register.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="Audio.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="Audio_details.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="Audio.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="Audio_details.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
